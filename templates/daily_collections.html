<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <title>📊 দৈনিক কালেকশন</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    @media print {
      @page { size: A4 portrait; margin: 8mm 5mm; }
      * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
      .no-print { display: none !important; }
      body { font-size: 10px; color: #000 !important; }
      .container { max-width: 100% !important; padding: 0 !important; margin: 0 !important; }
      table { font-size: 9px !important; page-break-inside: auto; width: 100% !important; border-collapse: collapse !important; }
      thead { display: table-header-group; }
      tbody { display: table-row-group; }
      tr { page-break-inside: avoid; page-break-after: auto; }
      th { padding: 3px !important; color: #fff !important; background-color: #000 !important; border: 1px solid #000 !important; }
      td { padding: 3px !important; color: #000 !important; border: 1px solid #000 !important; }
      .table-bordered { border: 1px solid #000 !important; }
      .table-bordered th, .table-bordered td { border: 1px solid #000 !important; }
      .text-success, .text-info, .text-danger, .text-primary { color: #000 !important; font-weight: bold; }
      span, strong { color: #000 !important; }
      h3, h5 { color: #000 !important; }
      .card { border: 1px solid #000 !important; page-break-inside: avoid; }
      .bg-success { background-color: #28a745 !important; }
      .bg-info { background-color: #17a2b8 !important; }
      .bg-primary { background-color: #0d6efd !important; }
      .text-white { color: #fff !important; }
      .card-body small, .card-body h5 { color: #fff !important; }
    }
  </style>

  <link rel="stylesheet" href="{{ url_for('static', filename='css/responsive.css') }}">
</head>
<body class="bg-light">
  <nav class="navbar navbar-dark bg-primary px-3 no-print">
    <span class="navbar-brand">
      {% if logo_exists %}
      <img src="{{ url_for('static', filename='images/logo.jpg') }}" alt="Logo" style="height: 35px; width: auto; margin-right: 8px; border-radius: 5px;">
      {% endif %}
      📊 দৈনিক কালেকশন
    </span>
    <div class="d-flex gap-2">
      <button onclick="window.print()" class="btn btn-light btn-sm">🖨️ প্রিন্ট</button>
      <form method="GET" class="d-flex gap-2">
        <input type="date" name="date" class="form-control form-control-sm" value="{{ selected_date.strftime('%Y-%m-%d') }}" style="width: 150px;">
        <button type="submit" class="btn btn-light btn-sm">দেখুন</button>
      </form>
      <a href="{{ url_for('dashboard') }}" class="btn btn-light btn-sm">← ফিরে যান</a>
    </div>
  </nav>

  <div class="container mt-4">
    <div class="d-none d-print-block text-center mb-3">
      {% if logo_exists %}
      <img src="{{ url_for('static', filename='images/logo.jpg') }}" alt="Logo" style="height: 60px; width: auto; margin-bottom: 10px;">
      {% endif %}
      <h3>আল-ইনসাফ ক্ষুদ্র ব্যবসায়ী সমবায় সমিতি লিঃ</h3>
      <h5>দৈনিক কালেকশন - {{ selected_date.strftime('%d-%m-%Y') }}</h5>
    </div>
    <h3 class="no-print">📅 {{ selected_date.strftime('%d %B %Y') }} - দৈনিক কালেকশন</h3>

    <div class="row mb-3">
      <div class="col-4">
        <div class="card bg-success text-white">
          <div class="card-body p-2">
            <small>💰 লোন কালেকশন</small>
            <h5>৳{{ "{:,.2f}".format(total_loan) }}</h5>
          </div>
        </div>
      </div>
      <div class="col-4">
        <div class="card bg-info text-white">
          <div class="card-body p-2">
            <small>🏦 সঞ্চয় কালেকশন</small>
            <h5>৳{{ "{:,.2f}".format(total_saving) }}</h5>
          </div>
        </div>
      </div>
      <div class="col-4">
        <div class="card bg-primary text-white">
          <div class="card-body p-2">
            <small>📊 সর্বমোট</small>
            <h5>৳{{ "{:,.2f}".format(total_loan + total_saving) }}</h5>
          </div>
        </div>
      </div>
    </div>

    <table class="table table-bordered table-striped">
      <thead class="table-dark">
        <tr>
          <th>ক্রমিক</th>
          <th>সদস্যা নং</th>
          <th>সদস্যার নাম</th>
          <th>লোন পরিমাণ</th>
          <th>সঞ্চয় পরিমাণ</th>
          <th>সময়</th>
          <th>স্টাফ</th>
        </tr>
      </thead>
      <tbody>
        {% for col in all_collections %}
        <tr>
          <td>{{ loop.index }}</td>
          <td><strong>{{ col.customer.member_no or '-' }}</strong></td>
          <td>{{ col.customer.name }}</td>
          <td>
            {% if col.loan_amount > 0 %}
            <span class="text-success">৳{{ "{:,.2f}".format(col.loan_amount) }}</span>
            {% else %}
            -
            {% endif %}
          </td>
          <td>
            {% if col.saving_amount > 0 %}
            <span class="text-info">৳{{ "{:,.2f}".format(col.saving_amount) }}</span>
            {% else %}
            -
            {% endif %}
          </td>
          <td>{{ col.date.strftime('%H:%M') }}</td>
          <td>{{ col.staff.name if col.staff else 'N/A' }}</td>
        </tr>
        {% endfor %}
        {% if not all_collections %}
        <tr>
          <td colspan="7" class="text-center">আজ কোনো কালেকশন নেই</td>
        </tr>
        {% endif %}
      </tbody>
    </table>


  </div>
</body>
</html>
